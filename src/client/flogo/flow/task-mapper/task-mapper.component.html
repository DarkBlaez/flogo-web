<div class="modal-wrapper" [@dialog]="modalState" (@dialog.start)="onModalStateChange($event)"
     (@dialog.done)="onModalStateChange($event)">
  <div class="mapper-modal qa-transform-modal" *ngIf="isActive">
    <div class="mapper-modal__header header">
      <h2 class="header__title">{{ title }}</h2>
      <div class="header__actions actions">
        <button class="flogo-button--secondary actions__action" (click)="cancel()">
          Cancel
        </button>
        <button class="flogo-button--primary  actions__action actions__action--save"
                [class.disabled]="!isValid || !isDirty" [disabled]="!isValid || !isDirty"
                (click)="saveTransform()">{{ 'TRANSFORM:SAVE' | translate }}
        </button>
      </div>
      <button class="mapper-modal__close" (click)="cancel()">
        <span aria-hidden="true" class="sr-only">{{ 'TRANSFORM:CLOSE' | translate }}</span>
      </button>
    </div>

    <div class="mapper-modal__content">
      <div class="tab-panel">
        <ul class="tabs">
          <li class="tabs__tab" [ngClass]='{"tabs__tab--selected": displayMapInputs}'
              (click)="showMapInputs()">Map Inputs
          </li>
          <li class="tabs__tab" [ngClass]='{"tabs__tab--selected": !displayMapInputs}'
              (click)="showIterators()">Iterators
          </li>
        </ul>
      </div>
      <div class="content">
        <div class="content__sidebar iterator-panel" *ngIf="displayIterators">
          <div class="iterator-switch">
            <div class="iterator-switch__text">Iterate</div>
            <div class="flogo-toggle-switch_container">
              <span *ngIf="iteratorModeOn">On</span>
              <span *ngIf="!iteratorModeOn">Off</span>
              <label class="flogo-toggle-switch">
                <input type="checkbox" [checked]="iteratorModeOn" (change)="changeIteratorMode($event)">
                <span class="flogo-toggle-switch_slider toggle-switch_round"></span>
              </label>
            </div>
          </div>
        </div>
        <flogo-mapper class="content__main" *ngIf="displayMapInputs || (displayIterators && iteratorModeOn)"
                      [isSingleInputMode]="displayIterators"
                      inputsSearchPlaceHolder="{{ inputsSearchPlaceholderKey | translate }}"
                      outputsSearchPlaceHolder="{{ 'TRANSFORM:AVAILABLE-DATA' | translate }}"
                      [context]="mapperContext" (mappingsChange)="onMappingsChange($event)"></flogo-mapper>
      </div>
    </div>
  </div>
</div>
